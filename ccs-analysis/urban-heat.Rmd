---
title: 'CCS Knowlede Map Results: Urban Heat'
author: "Corey Jackson"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
---


```{r setup, include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(DT)

# Import all datasets
heat_survey <- read.csv("/Volumes/cbjackson2/ccs-knowledge/ccs-data/urban-heat/heat_survey.csv")
heat_map <- read.csv("/Volumes/cbjackson2/ccs-knowledge/ccs-data/urban-heat/heat_map.csv")

# Questions - https://docs.google.com/document/d/1hl5Eb66a8j7TDE1EzzOF4eUjUguet5dMsw7UJydr_uY/edit

# Cleaning functions
clean_matrix <- function(dataframe, column_name) {
  cleaned_data <- dataframe %>%
    separate_rows({{ column_name }}, sep = "; ") %>%
    separate({{ column_name }}, into = c("question", "answer"), sep = " - ")
  cleaned_data$answer <- as.factor(cleaned_data$answer)
  
  summary_data <- cleaned_data %>%
    group_by(question, answer) %>%
    summarise(n = n()) %>%
    mutate(freq = round((n / sum(n)),digits=2     )*100)
  
  return(summary_data)
}


clean_box <- function(data, response) {
  summary_data <- data %>%
    group_by({{ response }}) %>%
    summarise(count = n()) %>%
    mutate(freq = round(count / sum(count), digits = 2)*100)
  
  return(summary_data)
}


clean_multi <- function(data, response) {
  cleaned_data <- data %>%
    separate_rows({{ response }}, sep = "; ")
  
  summary_data <- cleaned_data %>%
    group_by({{ response }}) %>%
    summarise(count = n()) %>%
    mutate(freq = round(count / sum(count), digits = 2) * 100)
  
  return(summary_data)
}
```

## Urban Heat (UH)
```{r uh-setup, include=FALSE, cache=TRUE}

# Run all analysis for the AQ survey here

```

- Description of survey and the questions asked

### UH Analysis
```{r uh-analysis-report, echo=TRUE}

# Report the analysis of survey items here
# Report the analysis of survey items here

names(heat_survey)[5:12] <- c("urban_heat_experience",
    "summer_activity_frequency",
    "disproportionate_heat_impact",
    "personal_heat_actions",
    "government_heat_mitigation",
    "heat_information_sources",
    "community_heat_participation",
    "heat_education_needs")
```

### Please rate how frequently you have done each of the following during summer months and during extreme heat.
```{r}
summer_activity_frequency <- clean_matrix(heat_survey, summer_activity_frequency)
datatable(summer_activity_frequency)
```


### Which of the following personal steps have you taken to reduce your contribution to urban heat and reduce greenhouse emissions?
```{r}
personal_heat_actions <- clean_multi(heat_survey, personal_heat_actions)
datatable(personal_heat_actions)
```


### Where do you currently go for information about heat (waves)? And how do you usually learn about extremely hot weather?
```{r}
heat_information_sources <- clean_multi(heat_survey, heat_information_sources)
datatable(heat_information_sources)
```


### Are you interested in participating in community-based efforts to address urban heat in your neighborhood?
```{r}
community_heat_participation <- clean_multi(heat_survey, community_heat_participation)
datatable(community_heat_participation)
```




 
### UH Map
```{r uh-map-report, echo=TRUE}

# Report the analysis of survey items here

```


# Meta Summary
